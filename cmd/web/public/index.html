<!DOCTYPE html>
<head>
    <style type="text/css">
html, body { height: 100%; margin: 0; padding: 0; }
    </style>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <meta charset="utf-8">
</head>
<body>
    <div class="container">
        <h1>Car suggest service</h1>
        <h3>Please enter known to you car model(vendor)</h3>
        <form>
            <div class="form-group">
                <input id="query" type="text" class="form-control">
            </div>
        </form>

        <div class="row">
            <div class="col-sm-4">
                <h4>NGramSize - 2</h4>
                <span class="holder" id="n2"/>
            </div>
            <div class="col-sm-4">
                <h4>NGramSize - 3</h4>
                <span class="holder" id="n3"/>
            </div>
            <div class="col-sm-4">
                <h4>NGramSize - 4</h4>
                <p class="holder" id="n4"/>
            </div>
        </div>
    </div>

    <script type="text/javascript">
    $(function() {
        var prev = '';
        $("#query").on("keyup", function(e) {
            var query = $("#query").val(), url;
            if (query.length < 3 || query === prev) {
                if (query !== prev) {
                    $('.holder').empty();
                }
                return;
            }

            prev = query;
            url = "/suggest/cars/" + encodeURIComponent(query) + "/";
            $.ajax(url)
                .done(function(json) {
                    var candidates = json.candidates, $holder, candidate, textArr;
                    for (var i = 0; i < candidates.length; ++i) {
                        candidate = candidates[i];
                        $holder = $('#' + candidate.config);
                        textArr = [];
                        for (var j = 0; j < candidate.data.length; ++j) {
                            textArr.push(candidate.data[j]);
                        }
                        
                        textArr.push("<small>Elapsed time: " + candidate.elapsed + "</small>");
                        $holder.empty().html(textArr.join('<br/>'));
                    }
                })
                .fail(function(err) {
                    alert(err);
                });
        });
    });
    </script>
</body>
</html>
